(function(){var c=document.getElementById("c"),l=c.getContext("2d",{alpha:!1});var q=Math.random,t=2*Math.PI;function da(a,b){return function(){a();b()}}function ea(a,b){var d=a.x-b.x;a=a.y-b.y;return Math.sqrt(d*d+a*a)}function fa(a,b){return Math.atan2(a.y-b.y,a.x-b.x)}function ha(a,b,d){var e=0;d.forEach(function(d){d.h.c==b&&(e+=t/a)});if(!(e>=t))return e}function u(a,b,d){return"hsl("+(0>a?360*q():a)+","+(0>b?100*q():b)+"%,"+(0>d?100*q():d)+"%)"}function ia(a,b,d){return a>d?d:a<b?b:a}function ja(a,b,d,e){var g=v,k=w;return g>a&&g<a+d&&k>b&&k<b+e}
function oa(){for(var a={x:x,y:y},b=999999,d=z[0],e=z.length;e--;){var g=ea(z[e],a);g<b&&(b=g,d=e)}return z[d]};var A=speechSynthesis,pa=!1,qa;A&&(pa=!0,qa=A.getVoices(),0>=qa.length&&(A.onvoiceschanged=function(){qa=A.getVoices()}));function B(a){pa&&(A.cancel(),a=new SpeechSynthesisUtterance(a),a.rate=1,a.pitch=.1,a.lang="en-US",a.voice=qa[3],A.speak(a))};function wa(){function a(a){return Math.sin(6.283184*a)}var b=[a,function(a){return.5>a%1?1:-1},function(a){return a%1*2-1},function(a){a=a%1*4;return 2>a?a-1:3-a}],d,e,g,k,h;this.A=function(a){d=a;e=a.C;g=0;k=a.s*a.o*(e+1)*2;h=new Int32Array(k)};this.D=function(){var f,ka,O,r,aa,P=new Int32Array(k),n=d.M[g],ba=d.s,ra=d.o,Qa=0,sa=0,F;var G=!1;var ta=[];for(ka=0;ka<=e;++ka){var la=n.p[ka];for(O=0;O<ra;++O){if(aa=la?n.f[la-1].b[O]:0)n.a[aa-1]=n.f[la-1].b[O+ra]||0,16>aa&&(ta=[]);var Mb=b[n.a[15]],Nb=
n.a[16]/512,Ob=Math.pow(2,n.a[17]-9)/ba,Pb=n.a[18],kb=n.a[19],Qb=135.82764118168*n.a[20]/44100,Rb=1-n.a[21]/255,Ra=1E-5*n.a[22],Sb=n.a[23]/32,Tb=n.a[24]/512,Ub=6.283184*Math.pow(2,n.a[25]-9)/ba,lb=n.a[26]/255,Sa=n.a[27]*ba&-2;aa=(ka*ra+O)*ba;for(r=0;4>r;++r)if(f=la?n.f[la-1].n[O+r*ra]:0){if(!ta[f]){var m=ta;var Q=f;var mb=F=void 0,ua,H,p=n,nb=f,Vb=b[p.a[0]],Wb=p.a[1],Xb=p.a[3],Yb=b[p.a[4]],Zb=p.a[5],$b=p.a[8],ob=p.a[9],ca=p.a[10]*p.a[10]*4,va=p.a[11]*p.a[11]*4,Ta=p.a[12]*p.a[12]*4,ac=1/Ta,ma=p.a[13],
bc=ba*Math.pow(2,2-p.a[14]),pb=new Int32Array(ca+va+Ta),qb=0,rb=0;for(ua=H=0;H<ca+va+Ta;H++,ua++){0<=ua&&(ma=ma>>8|(ma&255)<<4,ua-=bc,mb=.003959503758*Math.pow(2,(nb+(ma&15)+p.a[2]-128-128)/12),F=.003959503758*Math.pow(2,(nb+(ma&15)+p.a[6]-128-128)/12)*(1+8E-4*p.a[7]));var R=1;H<ca?R=H/ca:H>=ca+va&&(R-=(H-ca-va)*ac);var na=mb;Xb&&(na*=R*R);qb+=na;var Ua=Vb(qb)*Wb;na=F;$b&&(na*=R*R);rb+=na;Ua+=Yb(rb)*Zb;ob&&(Ua+=(2*Math.random()-1)*ob);pb[H]=80*Ua*R|0}m[Q]=pb}Q=ta[f];f=0;for(m=2*aa;f<Q.length;f++,
m+=2)P[m]+=Q[f]}for(f=0;f<ba;f++)r=2*(aa+f),(m=P[r])||G?(G=Qb,Pb&&(G*=Mb(Ob*r)*Nb+.5),G=1.5*Math.sin(G),Qa+=G*sa,m=Rb*(m-sa)-Qa,sa+=G*m,m=3==kb?sa:1==kb?m:Qa,Ra&&(m*=Ra,m=1>m?-1<m?a(.25*m):-1:1,m/=Ra),m*=Sb,G=1E-5<m*m,Q=Math.sin(Ub*r)*Tb+.5,F=m*(1-Q),m*=Q):F=0,r>=Sa&&(F+=P[r-Sa+1]*lb,m+=P[r-Sa]*lb),P[r]=F|0,P[r+1]=m|0,h[r]+=F|0,h[r+1]+=m|0}}g++;return g/d.J};this.B=function(){var a=44+2*k-8,b=a-36,d=new Uint8Array(44+2*k);d.set([82,73,70,70,a&255,a>>8&255,a>>16&255,a>>24&255,87,65,86,69,102,109,116,
32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,b&255,b>>8&255,b>>16&255,b>>24&255]);a=0;for(b=44;a<k;++a){var e=h[a];e=-32767>e?-32767:32767<e?32767:e;d[b++]=e&255;d[b++]=e>>8&255}return d}};var xa={M:[{a:[3,255,128,0,0,255,140,0,0,127,2,2,23,0,0,0,96,3,1,3,94,79,0,32,84,2,12,4],p:[1],f:[{n:[163],b:[]}]}],s:5513,o:1,C:0,J:1};var C=document.createElement("CANVAS"),D=C.getContext("2d");C.width=20;C.height=140;D.fillStyle="#dddddd";D.fillRect(8,50,4,40);D.fillStyle="#639bff";D.fillRect(2,0,15,60);D.fillRect(2,80,15,60);D.fillStyle="#9badb7";D.fillRect(2,65,17,10);D.fillRect(0,66,2,8);var ya=document.createElement("CANVAS"),za=ya.getContext("2d");ya.width=64;ya.height=64;za.fillStyle="#ff0000";za.moveTo(0,32);za.lineTo(64,0);za.lineTo(48,32);za.lineTo(64,64);za.fill();var Aa=0,Ba=0,Ca=["enemies, approaching","we are under attack","enemy, in-bound","hostiles detected"];function Da(){for(var a=100;a--;){var b=Math.random()*t;(new Ea(3E3*Math.cos(b),3E3*Math.sin(b))).direction=b}}Ba=600;var Fa=!0,Ga=[],Ha=!0,Ia=[],Ja=xa,Ka=new wa;Ka.w=new Audio;Ka.A(Ja);Ia.push(Ka);xa=Ka.w;var La=new wa;La.v=!0;
La.A({M:[{a:[2,100,128,0,3,201,128,0,0,0,0,6,29,0,0,0,194,4,1,3,25,191,115,244,147,6,84,6],p:[5,1,2,1,1,1,1,3,4,1,2,1,2,1,2,,,7,8,7,8,7,8,7,8,6,9],f:[{n:[123,123,135,128,123,123,135,130,126,125,126,128,123,123,135,128,123,123,135,130,126,125,126,128,123,123,135,128,123,123,135,130],b:[21,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,48]},{n:[123,123,135,128,123,123,135,130,126,125,126,128,123,123,135,128,123,123,135,130,126,125,126,128,123,,99,,,,99,,,,,,,,,,,,,,,,,,,,,,,,,,111],b:[,,,,,,,,,,,,,,,,,,,,,,,,,,,11,
13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31]},{n:[111,,,,,,,,123,,,,,,,,111,,,,,,,,123],b:[]},{n:[114,,,,,,,,126,,,,,,,,114,,,,,,,,114,126,111,123,114,126,118,130],b:[13,,,,,,,,,,,,,,,,,,,,,,,,13,,13,,13,,13,11,29,,,,,,,,,,,,,,,,,,,,,,,,32,,41,,29,,25,15]},{n:[123,123,135,128,123,123,135,130,126,125,126,128,123,123,135,128,123,123,135,130,126,125,126,128,123,,99,,,,99,,,,,,,,,,,,,,,,,,,,,,,,,,111],b:[13,11,21,17,,,,,,,,,,,,,,,,,,,,,,,,,,,,17,29,,25,113,,,,,,,,,,,,,,,,,,,,,,,,,,,,194]},{n:[111,,,,,,,,123,
,,,,,,,111,,,,,,,,99],b:[]},{n:[111,123,,123,111,,123,111,111,123,,123,111,,123,111,111,123,,123,111,,123,111,111,123,,123,111,,123,111],b:[]},{n:[114,126,,126,114,,126,114,114,126,,126,114,,126,114,114,126,,126,114,,126,114,116,128,,128,116,,114,121],b:[]},{n:[],b:[]}]},{a:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,0,0,2,14,1,1,39,76,5,0,0],p:[,1,1,1,1,1,1,2,,,,1,1,1,1,1,1,,,1,1,1,1,1,1],f:[{n:[147,,,,,,147,,,,147,,,,,,147,,,,,,147,,,,147,,,,147],b:[]},{n:[147],b:[]}]},{a:[0,0,140,0,0,0,140,0,0,
60,4,10,68,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,1,1,2,3,2,3,4,,,,2,3,2,3,2,3,,,5,5,5,5,5,5,4],f:[{n:[,,,,147,,,,,,,,148,,,,,,,,147,,,,,,,,147],b:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[,,,,147,,,147,,,,,148,,,,,,,,147,,,147,,,147,,,,147],b:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[,,,,147,,,147,,,,,148,,,,,,,,147,,,147,,,147,,,147,147,147],b:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[147],b:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,68]},{n:[147,,,147,,,147,,147,,,147,,147,,147,147,,,147,,
,147,,147,,,147,,147,,147],b:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]}]},{a:[2,192,128,0,2,192,140,18,0,0,107,115,138,0,0,0,136,5,1,2,8,92,21,56,148,5,85,8],p:[3,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2],f:[{n:[111],b:[]},{n:[114],b:[]},{n:[111],b:[24,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,56]}]},{a:[3,0,127,0,3,68,127,0,1,218,4,4,40,0,0,1,55,4,1,2,67,115,124,190,67,6,39,1],p:[,,,1,2,1,2,3,,,,1,2,1,2,1,2,,,1,4,1,4,1,4,3],f:[{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147],
b:[]},{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147,,147,147],b:[]},{n:[147],b:[]},{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147,,,147],b:[]}]},{a:[0,91,128,0,0,95,128,12,0,0,12,0,67,0,0,0,0,0,0,2,255,15,0,32,83,3,134,4],p:[,,,1,2,3,2,1,2,,,1,2,3,2,1,2,,,,,4,5,4,5],f:[{n:[159,,147,,154,,147,,157,,147,,154,,150,,159,,147,,154,,147,,162,,147,,154,,150,,123],b:[5,13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,67]},{n:[159,,147,,154,,147,,157,,147,,154,,150,,159,,147,,154,,147,,162,,147,,157,,162,,126],b:[]},{n:[159,
,147,,154,,147,,157,,147,,154,,150,,159,,147,,154,,147,,162,,147,,154,,150,,123],b:[5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,3]},{n:[159,,162,,164,,,,159,,162,164,,,162,,159,,162,,164,,,,159,,162,164,,,162],b:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25]},{n:[157,,162,,164,,,,157,,162,164,,,162,,157,,162,,164,,,,157,,162,164,,,162],b:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,67]}]},{a:[3,146,140,0,1,224,128,3,0,0,92,0,95,0,0,3,179,5,1,3,37,135,63,67,150,3,157,6],p:[,,,,,,,,,1,2,3,,1,2,1,
2,3,,4,5,,,,,3],f:[{n:[123,,,,,,,,,,,,,,,,130],b:[11,24,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,92,67]},{n:[133,,,,,,,,,,,,,,,138,126,,,,,,,,,,,,125],b:[11,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,,,95,,,,,,,,,,,,,,,,,,,,,,,,,,,,29]},{n:[123],b:[24,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,52,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,67]},{n:[123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,116],b:[11,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,95]},{n:[133,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,126,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,118],b:[]}]},
{a:[0,255,106,1,0,255,106,0,1,0,5,7,164,0,0,0,0,0,0,2,255,0,2,16,83,5,53,1],p:[,,,,,,,1,,,,,,,,,,1,,,,,,,,1],f:[{n:[147],b:[]}]}],s:5513,o:32,C:26,J:8});Ga.push(La);var Ma=0;function Na(){for(var a=0;a<Ga.length;a++){var b=Ga[a];b.v&&(b.v=1<=b.D(),Ma+=1,b=b.B(),b=URL.createObjectURL(new Blob([b],{type:"audio/wav"})),b=new Audio(b),b.addEventListener("ended",function(){this.currentTime=0;this.play()},!1),b.play(),b.volume=.5)}Ma>=Ga.length&&(Fa=!1)}var Oa=0;
function Pa(){for(var a=0;a<Ia.length;a++){var b=Ia[a];if(1<=b.D()){Oa+=1;var d=b.B();d=URL.createObjectURL(new Blob([d],{type:"audio/wav"}));b.w.src=d}}Oa>=Ia.length&&(Ha=!1)};var v=0,w=0,x=0,y=0,Va=!1,Wa=!1,Xa=!1,Ya=!1,Za=!1,$a=null,ab;window.addEventListener("mousemove",function(a){var b=c.getBoundingClientRect();v=a.clientX-b.left;w=a.clientY-b.top;x=(v+E-c.width/2)/I;y=(w+J-c.height/2)*K/I;ab&&(Wa=!0)},!1);window.addEventListener("mousedown",function(){ab=Va=!0},!1);window.addEventListener("mouseup",function(){ab=!1;Wa||(Xa=!0);Wa=!1},!1);window.addEventListener("wheel",function(a){Ya=0<a.deltaY;Za=0>a.deltaY},!1);var L={x:0,y:0,elements:[],u:"",L:function(){var a=c.width/2,b=c.height;L.elements=[bb(L,a-24-50,b-64,48,48,"Build Satellite",null,cb),bb(L,a-24,b-64,48,48,"Build Mining Station",null,db),bb(L,a+26,b-64,48,48,"Build Defense Platform",null,eb)]},update:function(){L.u="";fb();L.elements.forEach(function(a){a.update()})},g:function(){gb();L.elements.forEach(function(a){a.g()});l.fillStyle="#FFF";l.textAlign="center";l.textBaseline="middle";l.font="small-caps 700 32px monospace";l.fillText("next wave in",
c.width/2,32);l.font="700 64px monospace";l.fillText(~~(Ba/60),c.width/2,96);l.font="small-caps 700 32px monospace";l.fillText("minerals",c.width/2+300,48);l.fillText(~~M.m,c.width/2+300,80);l.font="small-caps 700 32px monospace";l.fillText("survived",c.width/2-300,48);l.fillText(Aa+" waves",c.width/2-300,80);l.font="small-caps 700 24px monospace";l.fillText(L.u,c.width/2,c.height-96)}};function cb(){B("Select an area to build the satellite")}
function db(){B("Select an area to build the mining station")}function eb(){B("Select an area to build the defense platform")}L.L();var hb=[];function ib(){var a=c.width/2-150,b=c.height/2-200,d={};hb.push(d);d.x=a;d.y=b;d.l=300;d.F=400;d.cache=null;d.display=!1;d.buttons=[];d.update=function(){d.display&&Va&&d.K()};d.K=function(){};d.g=function(){};d.show=function(){};return d}function fb(){for(var a=hb.length;a--;)hb[a].update()}function gb(){for(var a=hb.length;a--;)hb[a].display&&hb[a].g()};function bb(a,b,d,e,g,k,h,f){b=a.x+b;d=a.y+d;return{update:function(){var a=v,h=w;a>b&&a<b+e&&h>d&&h<d+g&&(L.u=k,Va&&f())},g:function(){l.fillStyle="#FFF";l.fillRect(b,d,e,g);h&&l.drawImage(h,b,d,e,g)}}};var E=0,J=0,jb=0,sb=0,tb=0,ub=0,vb=0,wb=0,I=1,xb=1,K=2;function yb(){if(Za||Ya)xb=ia(xb+(Za?.1:-.1),.1,2);K=Math.min(1+(I-.1),2);Va&&!zb.display&&(Ab=!0,tb=E,ub=J,vb=v,wb=w);Wa&&Ab?(jb=tb+(vb-v),sb=ub+(wb-w)):Xa&&(Ab=!1);var a=I;I+=.001>Math.abs(I-xb)?0:(xb-I)/5;a=I-a;.001<Math.abs(a)&&(E+=x*a,J+=y*a,jb+=x*a,sb+=y*a);E+=.001>Math.abs(E-jb)?0:(jb-E)/5;J+=.001>Math.abs(J-sb)?0:(sb-J)/5}function Bb(){l.setTransform(1,0,0,1,0,0)}var Ab;var Cb="";Db();window.addEventListener("resize",Db,!1);function Db(){c.width=window.innerWidth;c.height=window.innerHeight;l.clearRect(0,0,c.width,c.height);L.L()}function Eb(){l.globalAlpha=1;for(var a=z.length;a--;){var b=z[a];b.h&&Fb(b);var d=Math.floor(4*I);b.j&&b.j[d]&&(d=b.j[d],l.save(),l.translate(b.x,b.y/K),l.scale(1,1/K),l.drawImage(d,0,0,d.width,d.height),l.scale(-1,1),l.drawImage(d,0,0),l.scale(1,-1),l.drawImage(d,0,0),l.scale(-1,1),l.drawImage(d,0,0),l.restore())}}
function Fb(a){var b=a.h;if(b){var d=b.c.j;d||(d=b.c.j=[]);var e=Math.floor(4*I);d=d[e];if(!d){d=document.createElement("CANVAS");var g=0;z.forEach(function(a){a.h&&a.h.c===b.c&&(g=Math.max(g,a.h.i+40))});d.width=g;d.height=g;b.c.j[e]=d;d.G=[]}if(!d.G[a.id]){e=.1+e/4;var k=d.getContext("2d");k.setLineDash([5/e,5/e]);k.beginPath();k.lineWidth=2/e;k.strokeStyle=a.color;k.globalAlpha=.6;k.arc(0,0,b.i,0,t/4,!1);k.stroke();k.setLineDash(Gb);d.G[a.id]=!0}}}var Gb=[];
function Hb(){l.globalAlpha=1;for(var a=z.length;a--;){var b=z[a];if(b.type===Ib){var d=fa(b,z[0]);l.save();l.translate(b.x,b.y/K);l.rotate(d);l.scale(.2,.2);l.drawImage(C,-C.width/2,-C.height/2)}else{if(!b.cache){var e=b.type===Jb,g=e?"#ffffff":b.color,k=e?50:10;d=b.size+k;var h=0,f=b.cache=document.createElement("CANVAS");f.width=2*d;f.height=2*d;f=b.cache.getContext("2d");e&&(h=1E3,f.shadowOffsetY=h);f.beginPath();f.fillStyle=g;f.shadowColor=b.color;f.shadowBlur=k;f.arc(d,d-h,b.size,0,t,!1);f.fill();
e&&(f.beginPath(),f.shadowColor="#FFF",f.shadowBlur=5,f.arc(d,d-h,b.size-5,0,t,!1),f.fill());if(!e)for(g=e=b.size,f.beginPath(),f.arc(d,d,b.size,0,2*Math.PI,!1),f.clip();e--;)f.beginPath(),f.globalAlpha=.05,f.fillStyle="#000",f.shadowColor="#000",f.shadowBlur=10,f.save(),f.transform(1,0,0,1,d-g/2+(b.size-g)/2,d),f.arc(0,0,2*g--,-t/4,t/4),f.fill(),f.restore()}d=fa(b,z[0]);l.save();l.translate(b.x,b.y/K);l.rotate(d);b.I&&(d=1+.01*Math.sin(performance.now()/30),l.scale(d,d));l.drawImage(b.cache,-b.cache.width/
2,-b.cache.height/2)}l.restore()}}function Kb(){l.beginPath();for(var a=75*(K-1),b=0;b<N.length;b++)for(var d=N[b],e=b;e<N.length;e++){var g=N[e];if(g!=d&&ea(g,d)<=M.N){var k=d.y/K,h=g.y/K;l.moveTo(d.x,k);l.bezierCurveTo(d.x,k-a,g.x,h-a,g.x,h)}}l.globalAlpha=ia(.2/I,.2,.8);l.lineWidth=ia(1/I*2,1,4);l.strokeStyle="#0F0";l.stroke();l.globalAlpha=1};var Lb=document.createElement("CANVAS");Lb.width=512;Lb.height=512;var S=Lb.getContext("2d");S.shadowBlur=1;S.globalAlpha=.5;for(var cc=300;cc--;){var dc=512*Math.random(),ec=512*Math.random(),fc=u(-1,100,90);S.fillStyle=fc;S.shadowColor=fc;S.beginPath();S.arc(dc,ec,.5,0,2*Math.PI);S.fill()}var gc=l.createPattern(Lb,"repeat");
function hc(){var a=performance.now()/2E3;l.beginPath();l.rect(0,0,c.width,c.height);l.fillStyle=gc;l.translate(.5*c.width,.5*c.height);l.scale(.5,.5);l.translate(-E/25,-J/25);l.rotate(a/200);l.fill();l.rotate(-a/200);l.scale(2,2);l.translate(-E/50,-J/50);l.fill()}var ic=document.createElement("CANVAS"),jc=ic.getContext("2d",{alpha:!1});ic.width=512;ic.height=512;jc.beginPath();var kc=jc.createRadialGradient(256,256,0,256,256,256);kc.addColorStop(0,"#141e28");kc.addColorStop(1,"#000000");
jc.fillStyle=kc;jc.fillRect(0,0,512,512);var z=[],N=[],lc=[],Jb=0,Ib=2;
function mc(a,b,d,e,g,k){void 0===k&&(k=0);var h={name:"Some Shithole Planet"};h.type=Jb;h.x=0;h.y=0;h.color=a;h.size=b;h.I=!1;h.id=z.length.toString();d&&(h.h={c:d,i:e,speed:g,angle:k});h.update=function(){if(h.h){var a=h.h;a.angle+=a.speed;h.x=a.i*Math.cos(a.angle)+a.c.x;h.y=a.i*Math.sin(a.angle)+a.c.y}};h.g=function(){var a=h.h;if(a){l.beginPath();l.globalAlpha=.4;l.strokeStyle=h.color;l.lineWidth=4/I;l.save();var b=1/K;l.transform(1,0,0,b,a.c.x,a.c.y*b);l.arc(0,0,a.i,a.angle-a.speed*a.i/2,a.angle,
0>a.speed);l.restore();l.stroke()}};z.push(h);return h}function nc(a,b,d,e,g,k){void 0===k&&(k=0);a=mc(a,b,d,e+b/2,g,k);a.name="Planet";a.type=1;a.update=da(a.update,function(){});return a}function oc(a){void 0!==ha(pc,a,N)&&(a=mc(u(212,100,97),2,a,3*a.size,-.005,null),a.name="Mining Station",a.type=3,a.update=da(a.update,function(){M.m+=M.O}))}var pc=4;function T(a){var b=ha(qc,a,N);void 0!==b&&(a=mc(u(160,100,50),2,a,5*a.size,.01,b),a.name="Satellite",a.type=Ib,a.index=N.length,N.push(a))}
var qc=3;function rc(a){var b=ha(sc,a,lc);void 0!==b&&(a=mc(u(33,100,50),2,a,7*a.size,.005,b),a.name="Defense Platform",a.type=4,a.index=lc.length,lc.push(a))}var sc=2;function Ea(a,b){this.x=a;this.y=b;this.speed=5;this.direction=0;this.target=z[0];U.push(this)}
Ea.prototype={update:function(){var a=fa(this,this.target)-this.direction+t/2;this.direction+=.01*(a-Math.floor(a/t)*t-t/2);this.x-=this.speed*Math.cos(this.direction);this.y-=this.speed*Math.sin(this.direction);100>ea(this,this.target)&&U.splice(U.indexOf(this),1)},g:function(){l.save();l.translate(this.x,this.y/K-20*K);l.scale(.2,.2/K);l.rotate(this.direction);l.drawImage(ya,-ya.width/2,-ya.height/2);l.restore()}};var U=[];function tc(){for(var a=U.length;a--;)U[a].update()}
function uc(){for(var a=U.length;a--;)U[a].g()};var vc=!1,wc=60;
function xc(){var a=c.width/2,b=c.height/2;l.fillStyle="#FFF";l.textAlign="center";l.textBaseline="middle";l.shadowColor="#FFF";l.shadowBlur=50+2*Math.sin(performance.now()/100);l.font="small-caps 700 256px monospace";l.fillText("X",a,b-64);l.fillText("e o",a,b-90);l.shadowBlur=0;l.font="small-caps 700 32px monospace";Fa?l.fillText("Loading music...",a,b+64):Ha?l.fillText("Loading sounds...",a,b+64):l.fillText("Click to continue!",a,b+64);l.font="small-caps 700 16px monospace";l.fillText("Created by",a,
c.height-68);l.fillText("ai Doge & Jack Oatley",a,c.height-48);l.fillText("for #js13k",a,c.height-28)};var zb=function(){var a=ib();a.buttons.push(bb(a,125,175,50,50,"Satellite",C,function(){B("choose a target");a.H()}));a.show=function(b){$a=a;a.display=!0;a.target=b};a.H=function(){a.target=null;a.display=!1;$a=null};a.K=function(){$a==a&&ja(a.x,a.y,a.l,a.F)?a.buttons.forEach(function(a){a.update()}):a.H()};a.g=function(){l.fillStyle="#141e28";l.fillRect(a.x,a.y,a.l,a.F);l.fillStyle="#fff";l.textAlign="center";l.font="24px monospace";l.fillText((M.c===a.target?"Base":"")+" "+a.target.name,a.x+a.l/
2,a.y+20);var b=a.target.cache;l.drawImage(b,a.x+a.l/2-b.width/2,a.y+100-b.height/2);a.buttons.forEach(function(a){a.g()})};return a}(),M=null,V=0;window.addEventListener("contextmenu",function(a){a.preventDefault()},!1);document.addEventListener("keypress",function(a){console.log(a.key);" "===a.key&&(3===V?V=1:V=3)});var yc=u(60,100,50),W=mc(yc,50,null,null,null,null);W.name="The Sun";W.type=Jb;W.I=!0;var X=nc(u(180,39,62),10,W,500,.003,q()*t),Y={};Y.c=X;Y.O=.01;Y.P=300;Y.R=0;Y.S=0;Y.N=500;Y.m=0;
M=Y;nc(u(-1,60,70),5,X,100,-.002,q()*t);var Z=nc(u(-1,60,70),20,W,1123,.0015,q()*t);nc(u(-1,60,70),5,Z,8*Z.size,.01,q()*t);nc(u(-1,60,70),10,Z,9*Z.size,.005,null);nc(u(-1,60,70),30,W,2532,-.001,q()*t);oc(X);oc(Z);T(X);T(W);T(W);T(W);T(Z);T(Z);T(Z);rc(X);rc(X);rc(X);rc(Z);var zc=performance.now(),Ac=1E3/60,Bc=0,Cc=0,Dc=[];
(function Ec(a){requestAnimationFrame(Ec);var d=zc+Ac;Dc.push(1/((a-Bc)/1E3));Bc=a;if(60<Dc.length){var e=0,g=1E3,k=0;Dc.shift();Dc.forEach(function(a){e+=a;g=Math.min(g,a);k=Math.max(k,a)});Cc=Math.floor(e/60)+", "+~~g+" - "+~~k}a>d&&(Fc(Math.min(Math.floor((a-zc)/Ac),60)),Gc(),zc=a)})(zc);
function Fc(a){if(0===V)0<wc--||(Fa?Na():Ha?Pa():(vc||(vc=!0,B("Welcum to Exo")),Va&&(V=1)));else{Cb="";yb();L.update();1===V&&(z.forEach(function(a){a.update()}),Ba--||(Da(),Ba=600,Aa++,B(Ca[~~(Math.random()*Ca.length)])),tc());var b=oa();64>ea(b,{x:x,y:y})&&(Cb=b.name,$a||!Xa||Wa||1!=b.type||(B("selected "+b.name),zb.show(b),xa.play()))}Ya=Za=Xa=Va=!1;--a&&Fc(a)}
function Gc(){Bb();l.clearRect(0,0,c.width,c.height);l.drawImage(ic,Math.floor(.5*c.width-E-2048),Math.floor(.5*c.height-J-2048),4096,4096);hc();if(0===V)Bb(),xc();else{l.setTransform(I,0,0,I,-E+c.width/2,-J+c.height/2);z.forEach(function(a){a.g()});l.globalAlpha=1;Eb();Hb();uc();Kb();var a=oa();64>ea(a,{x:x,y:y})&&(l.beginPath(),l.moveTo(a.x,a.y/K),l.lineTo(x,y/K),l.strokeStyle="#ffffff",l.stroke());l.setTransform(1,0,0,1,c.width/2,c.height/2);Bb();L.g();l.font="14px monospace";l.textBaseline="top";
l.textAlign="left";l.fillStyle="#fff";l.fillText("#js13k tower defense prototype",20,20);l.fillText("https://github.com/scorp200/td13k",20,40);l.fillText("framerate: "+Cc,20,60);l.fillText("mouse (gui): "+v+", "+w,20,80);l.fillText("mouse (view): "+x+", "+y,20,100);l.fillText("planet name: "+Cb,20,120);l.fillText("view x: "+E,20,160);l.fillText("view y: "+J,20,180);l.fillText("view zoom: "+I,20,200);l.fillText("view tilt: "+K,20,220)}};}).call(this);
